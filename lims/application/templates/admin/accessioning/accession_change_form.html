{% extends "admin/change_form.html" %}
{% block content_title %}
{{ block.super }}
<br/><br/>
<h6 style="color: darkblue; margin-bottom: 20px; margin-right: 30px;">
    {{ accession_id }} | Status: {{ status }}
</h6>
{% endblock %}
{% block object-tools-items %}
{{ block.super }}
<br/>
<div class="object-tools">
    <a id="btn-add-del-test" class="btn btn-block btn-primary btn-sm" href="#" onclick="adddeletetest()">Add/Delete Test</a>
    <a id="btn-update-acc-prefix" class="btn btn-block btn-primary btn-sm" href="#" onclick="updateaccessionprefix()">Update Accession Prefix</a>
    <a id="create-more-samples" class="btn btn-block btn-success btn-sm" href="#" onclick="createMoreSamples()">Create Samples</a>
    <a id="btn-generate-accession" class="btn btn-block btn-success btn-sm"
       href="/gulfcoastpathologists/accessioning/accession/{{ original.pk }}/generate_accession/"
    >
        Generate Accession
    </a>
    <a id="btn-scan-upload-file" class="btn btn-block btn-primary btn-sm" href="#" onclick="scanandupload()">Scan & Upload</a>
</div>

<!-- Scan Preview Modal -->
<div id="scanPreviewModal"
     style="
         display: none;
         background: #fff;
         border: 1px solid #ccc;
         padding: 0;
         position: fixed;
         top: 50%; left: 50%;
         z-index: 1000;
         width: 70vw; height: 80vh;
         transform: translate(-50%, -50%);
         border-radius: 10px;
         box-shadow: 0 0 20px rgba(0,0,0,0.4);
         flex-direction: column;
         overflow: auto;
     ">

    <!-- Modal Header -->
    <div style="
        background: #007bff;
        color: white;
        padding: 10px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    ">
        <h4 style="margin: 0;">Scan Preview</h4>
    </div>

    <!-- Scrollable Image Container -->
    <div style="
        flex: 1;
        min-height: 0;                /* critical: prevents overflow */
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f9f9f9;
        overflow: auto;               /* enables scrolling */
        padding: 10px;
    ">
        <img id="preview"
             src=""
             alt="Scanned Document Preview"
             style="
                 max-width: 95%;
                 max-height: none;     /* allow full height to enable scrolling */
                 border: 1px solid #ccc;
                 border-radius: 8px;
                 background: white;
             ">
    </div>

    <!-- Buttons -->
    <div style="display: flex; justify-content: flex-end; gap: 10px; padding: 10px 20px;">
        <button type="button" class="btn btn-secondary" onclick="closeModal()">Close</button>
        <button type="button" class="btn btn-primary" onclick="uploadScan()">Upload</button>
    </div>
</div>

<div id="modalOverlay" style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
    "></div>

{% endblock %}
